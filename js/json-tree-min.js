/**
 * JSON Tree
 * =========
 * 
 * Author : Devendra Nationalwala
 * 
 */

var $sourceControl=[];$.fn.createTree=function(e){function r(e){if(void 0!==e.children){resultHtml+='<div class="childContainer">';for(var o=0;o<e.children.length;o++)void 0===e.children[o].children||0===e.children[o].children.length?resultHtml+='<i class="glyphicon glyphicon-chevron-down whiteIco"></i><div class="childNode draggableTreeNode droppableTreeNode '+e.children[o]["class"]+'">'+e.children[o].label+'<p style="display:none">'+e.children[o].id+"</p></div>":(a.push(e.children[o].id),resultHtml+='<i class="glyphicon glyphicon-chevron-down toggleArrow"></i><div class="parentNode droppableTreeNode draggableTreeNode '+e.children[o]["class"]+'"><b>'+e.children[o].label+'</b><p style="display:none">'+e.children[o].id+"</p></div>"),r(e.children[o]);resultHtml+="</div>"}return!0}function o(e,r){for(var o=0;o<n.jsonTreeObj.length;o++)n.jsonTreeObj[o].id===r&&(n.jsonTreeObj[o].parent=e);for(var o=0;o<n.jsonTreeObj.length;o++)n.jsonTreeObj[o].children=void 0;$sourceControl.createTree({jsonTreeObj:n.jsonTreeObj})}$sourceControl=this;for(var l,n=$.extend({jsonTreeObj:[],isDraggable:!0},e),s=0;s<n.jsonTreeObj.length-1;s++)for(var i=s+1;i<n.jsonTreeObj.length;i++)n.jsonTreeObj[s].parent>n.jsonTreeObj[i].parent&&(l=n.jsonTreeObj[i],n.jsonTreeObj[i]=n.jsonTreeObj[s],n.jsonTreeObj[s]=l);for(var d=[],s=0;s<n.jsonTreeObj.length;s++){d.push(n.jsonTreeObj[s]),void 0===n.jsonTreeObj[s].children&&(n.jsonTreeObj[s].children=[]);for(var i=0;i<n.jsonTreeObj.length;i++)n.jsonTreeObj[s].id===n.jsonTreeObj[i].parent&&n.jsonTreeObj[s].children.push(n.jsonTreeObj[i])}$sourceControl.html(""),resultHtml="<div class=treeContainer>";for(var a=[],s=0;s<n.jsonTreeObj.length;s++)if(n.jsonTreeObj[s].children.length>0&&-1===a.indexOf(n.jsonTreeObj[s].id)){resultHtml+='<br/><i class="glyphicon glyphicon-chevron-down toggleArrow"></i><div class="ripplelink parentNode droppableTreeNode '+n.jsonTreeObj[s]["class"]+'"><b>'+n.jsonTreeObj[s].label+'</b><p style="display:none">'+n.jsonTreeObj[s].id+"</p></div>",a.push(n.jsonTreeObj[s].id);var t=n.jsonTreeObj[s];r(t)}resultHtml+="</div>",$sourceControl.html(resultHtml),setTimeout(function(){n.isDraggable?($(".draggableTreeNode").addClass("showDraggable"),$(".draggableTreeNode").draggable({revert:!0,helper:"clone"}),$(".droppableTreeNode").droppable({hoverClass:"treeNodeHover",drop:function(e,r){o($(this).find("p").html(),r.draggable.find("p").html())}})):$(".draggableTreeNode").removeClass("showDraggable"),$(".toggleArrow").click(function(){$(this).hasClass("closed")?($(this).removeClass("glyphicon-play"),$(this).addClass("glyphicon-chevron-down"),$(this).removeClass("closed"),$(this).next().next().show()):($(this).addClass("closed"),$(this).addClass("glyphicon-play"),$(this).removeClass("glyphicon-chevron-down"),$(this).next().next().hide())})},500)};